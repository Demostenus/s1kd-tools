README_SRC=DMC-S1000DTOOLS-A-00-00-00-00A-040A-D_EN-CA.XML
INTRO_SRC=DMC-S1000DTOOLS-A-00-00-00-00A-018A-D_EN-CA.XML
DEFAULTS_SRC=DMC-S1000DTOOLS-A-00-00-00-00A-014A-D_EN-CA.XML
INSTALL_SRC=DMC-S1000DTOOLS-A-00-00-00-00A-720A-D_EN-CA.XML
EXAMPLE_SRC=DMC-S1000DTOOLS-A-00-00-00-00A-130A-D_EN-CA.XML

README=../README.md
INTRO=../INTRO.md
DEFAULTS=../DEFAULTS.md
INSTALL=../INSTALL.md
EXAMPLE=../EXAMPLE.md

S1KD2DB=s1kd2db
S1KD2DB_FLAGS+=-param include.emphasis.role 1

PANDOC_MD=pandoc -f docbook -t markdown_github -s
PANDOC_MAN=pandoc -f docbook -t man -s

MANPAGE=s1kd-tools.1

MAN_PREFIX=/usr/local/share/man/man1

all: $(MANPAGE)

$(README): $(README_SRC)
	$(S1KD2DB) $(README_SRC) | $(PANDOC_MD) -o $(README)

$(INTRO): $(INTRO_SRC)
	$(S1KD2DB) $(INTRO_SRC) $(S1KD2DB_FLAGS) | $(PANDOC_MD) -o $(INTRO)

$(DEFAULTS): $(DEFAULTS_SRC)
	$(S1KD2DB) $(DEFAULTS_SRC) $(S1KD2DB_FLAGS) | $(PANDOC_MD) -o $(DEFAULTS)

$(INSTALL): $(INSTALL_SRC)
	$(S1KD2DB) $(INSTALL_SRC) $(S1KD2DB_FLAGS) | $(PANDOC_MD) -o $(INSTALL)

$(EXAMPLE): $(EXAMPLE_SRC)
	$(S1KD2DB) $(EXAMPLE_SRC) $(S1KD2DB_FLAGS) | $(PANDOC_MD) -o $(EXAMPLE)

$(MANPAGE): $(INTRO_SRC)
	$(S1KD2DB) $(INTRO_SRC) $(S1KD2DB_FLAGS) | $(PANDOC_MAN) -o $(MANPAGE)

install:
	cp $(MANPAGE) $(MAN_PREFIX)/

clean:
	rm -f $(MANPAGE)
